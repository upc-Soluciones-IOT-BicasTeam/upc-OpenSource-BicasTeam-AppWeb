<div class="report-screen" lang="es">
  <!-- HEADER -->
  <header class="header">
    <img class="logo" src="https://i.ibb.co/RCDQZnJ/logo.png" alt="Logo MoviGestión">
    <h1 class="title">Reportes de Incidentes</h1>
  </header>

  <!-- CONTROLES -->
  <div class="controls">
    <div class="filter">
      <label for="typeFilter" class="sr-only">Filtrar por tipo</label>
      <select id="typeFilter"
              [(ngModel)]="selectedType"
              (ngModelChange)="onTypeChange($event)">
        <option *ngFor="let t of types" [value]="t">
          {{ t === 'All' ? 'Todos los tipos' : t }}
        </option>
      </select>
    </div>

    <div class="search">
      <label for="searchTerm" class="sr-only">Buscar conductor o descripción</label>
      <input id="searchTerm"
             type="search"
             placeholder="Buscar por conductor o descripción..."
             [(ngModel)]="searchTerm"
             (ngModelChange)="onSearch($event)">
      <i class="icon-search" aria-hidden="true"></i>
    </div>
  </div>

  <!-- TABLA DE REPORTES -->
  <div class="table-container">
    <table>
      <thead>
      <tr>
        <th scope="col">Tipo</th>
        <th scope="col">Descripción</th>
        <th scope="col">Conductor</th>
        <th scope="col">Fecha</th>
        <th scope="col">Acción</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let report of filteredReports">
        <td>{{ report.type }}</td>
        <td>{{ report.description }}</td>
        <td>{{ report.driverName }}</td>
        <td>{{ report.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
        <td>
          <button class="btn btn--check"
                  (click)="openResolveConfirm(report)"
                  aria-label="Marcar como resuelto">
            <mat-icon>check_circle</mat-icon>
          </button>
        </td>
      </tr>

      <tr *ngIf="!filteredReports.length">
        <td colspan="5" class="no-results">
          No se encontraron reportes con los criterios seleccionados.
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- MODAL DE CONFIRMACIÓN -->
  <div class="confirm-overlay" *ngIf="showResolveModal"
       role="alertdialog" aria-modal="true"
       aria-labelledby="resolveTitle"
       aria-describedby="resolveText">
    <div class="confirm-modal" role="document">
      <h3 id="resolveTitle" class="confirm-title">Confirmar Resolución</h3>
      <p id="resolveText" class="confirm-text">
        ¿Confirmas que este incidente ya fue resuelto y deseas eliminarlo?
      </p>
      <div class="confirm-buttons">
        <button type="button" class="btn btn--secondary" (click)="cancelResolve()">
          Cancelar
        </button>
        <button type="button" class="btn btn--danger" (click)="confirmResolve()">
          Sí, resolver
        </button>
      </div>
    </div>
  </div>
</div>
