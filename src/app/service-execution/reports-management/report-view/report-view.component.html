<!-- src/app/report-view/report-view.component.html -->
<div class="report-screen">
  <!-- HEADER -->
  <header class="header">
    <div class="header-text">
      <h1 class="title">{{ 'REPORT.HEADER.TITLE' | translate }}</h1>
      <p class="subtitle">{{ 'REPORT.HEADER.SUBTITLE' | translate }}</p>
    </div>
    <img
      class="logo"
      src="https://i.ibb.co/RCDQZnJ/logo.png"
      alt="{{ 'REPORT.HEADER.LOGO_ALT' | translate }}"
    />
  </header>

  <!-- CONTROLES: filtro + b√∫squeda -->
  <div class="controls">
    <div class="filter">
      <select
        [(ngModel)]="selectedLevel"
        (ngModelChange)="onLevelChange($event)"
        class="filter-select"
      >
        <option
          *ngFor="let lvl of levels"
          [value]="lvl"
        >
          {{ lvl }}
        </option>
      </select>
      <i class="icon-chevron-down"></i>
    </div>
    <div class="search">
      <input
        type="text"
        placeholder="{{ 'REPORT.CONTROLS.SEARCH_PLACEHOLDER' | translate }}"
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearch($event)"
      />
      <button>
        <i class="icon-search"></i>
      </button>
    </div>
  </div>

  <!-- TABLA ESTILIZADA -->
  <div class="table-container">
    <table>
      <thead>
      <tr>
        <th scope="col">{{ 'REPORT.TABLE.DRIVER_NAME' | translate }}</th>
        <th scope="col">{{ 'REPORT.TABLE.DESCRIPTION' | translate }}</th>
        <th scope="col">{{ 'REPORT.TABLE.DATE' | translate }}</th>
        <th scope="col">{{ 'REPORT.TABLE.TIME' | translate }}</th>
        <th scope="col">{{ 'REPORT.TABLE.LEVEL' | translate }}</th>
      </tr>
      </thead>
      <tbody>
      <tr
        *ngFor="let report of filteredReports"
        class="clickable-row"
        (click)="selectReport(report)"
      >
        <td>{{ report.driverName }}</td>
        <td>{{ report.description }}</td>
        <td>{{ report.createdAt | date:'dd/MM/yyyy' }}</td>
        <td>{{ report.createdAt | date:'hh:mm a' }}</td>
        <td>
          <div class="badge-container">
              <span
                class="badge"
                [ngClass]="'badge--' + report.level.toLowerCase()"
              >
                {{ report.level }}
              </span>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- MODAL DE DETALLES -->
  <div
    class="overlay"
    *ngIf="selectedReport"
    (click)="closeDetails()"
  >
    <div
      class="modal-window"
      (click)="$event.stopPropagation()"
    >
      <header class="modal-header">
        <h2>{{ 'REPORT.MODAL.TITLE' | translate }}</h2>
        <button class="close-btn" (click)="closeDetails()">&times;</button>
      </header>

      <section class="modal-info">
        <div>
          <strong>{{ 'REPORT.MODAL.DATE_LABEL' | translate }}:</strong>
          {{ selectedReport.createdAt | date:'dd/MM/yyyy' }}
        </div>
        <div>
          <strong>{{ 'REPORT.MODAL.TIME_LABEL' | translate }}:</strong>
          {{ selectedReport.createdAt | date:'hh:mm a' }}
        </div>
      </section>

      <section class="modal-details">
        <div class="detail-row">
          <span class="label">{{ 'REPORT.MODAL.TECHNICAL' | translate }}:</span>
          <span>{{ selectedReport.technicalProblems }}</span>
        </div>
        <div class="detail-row">
          <span class="label">{{ 'REPORT.MODAL.INFRACTIONS' | translate }}:</span>
          <span>{{ selectedReport.vehicularInfractions }}</span>
        </div>
        <div class="detail-row">
          <span class="label">{{ 'REPORT.MODAL.ACCIDENTS' | translate }}:</span>
          <span>{{ selectedReport.roadAccidents }}</span>
        </div>
        <div class="detail-row">
          <span class="label">{{ 'REPORT.MODAL.PACKAGE' | translate }}:</span>
          <span>{{ selectedReport.packageProblems }}</span>
        </div>
      </section>

      <footer class="modal-footer">
        <button
          class="btn delete-selected"
          (click)="openDeleteConfirm(selectedReport!)"
        >
          üóëÔ∏è {{ 'REPORT.MODAL.DELETE' | translate }}
        </button>
      </footer>
    </div>
  </div>

  <!-- DIALOG DE CONFIRMACI√ìN DE BORRADO -->
  <div class="confirm-overlay" *ngIf="showDeleteModal">
    <div class="confirm-modal">
      <p class="confirm-text">
        {{ 'REPORT.DELETE_CONFIRM.TEXT' | translate }}
      </p>
      <div class="confirm-buttons">
        <button class="btn confirm-yes" (click)="confirmDelete()">
          {{ 'REPORT.DELETE_CONFIRM.YES' | translate }}
        </button>
        <button class="btn confirm-no" (click)="cancelDelete()">
          {{ 'REPORT.DELETE_CONFIRM.NO' | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
